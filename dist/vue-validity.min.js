!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e["vue-validity"]=e["vue-validity"]||{})}(this,function(e){"use strict";function t(e,t){var n=".";t=t.replace(/\[(\w+)\]/g,n+"$1"),t="."+t;var r=new RegExp("^\\"+n);t=t.replace(r,"");for(var i=t.split(n),o=0;o<i.length;++o){var a=i[o];if(!(a in e))return;e=e[a]}return e}function n(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function r(e,t){e.classList?e.classList.add(t):n(e,t)||(e.className+="  "+t)}function i(e,t){if(e.classList)e.classList.remove(t);else if(n(e,t)){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ")}}function o(e){return a(e)&&("function"==typeof e.message||"function"==typeof e.validate)}function a(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":x(e))}function u(e){return a(e)&&("undefined"==typeof e.$message||"undefined"==typeof e.$value)}function s(e,t){t=Object.assign({},w,t),r(e,t.dirty),i(e,t.pristine)}function l(e,t){t=Object.assign({},w,t),r(e,t.pristine),i(e,t.dirty)}function c(e,n){var r=n.context.$v||n.context.$vnode.context.$v;if(!r)return null;if(n.context.$vChild)return r;var i=e.value;if(!i){var o=n.data.directives.filter(function(e){return"model"===e.name});if(o.length)i=o[0].expression;else{var a=n.context.$options._parentVnode.data||[],u=a.directives.filter(function(e){return"model"===e.name});a.directives.length||(i=""),i=u[0].expression}}return i?t(r,i):r}function f(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;o=Object.assign(w,o);var a=c(t,n);if(a){var u=a.$dirty,s=a.$valid;u?(r(e,o.touched),i(e,o.untouched)):(r(e,o.untouched),i(e,o.touched)),s?(r(e,o.valid),i(e,o.invalid)):(r(e,o.invalid),i(e,o.valid))}}function d(e,t){return e[t]}function v(e){if(L)return L;for(var t=e.constructor;t.super;)t=t.super;return L=t,t}function h(e){this.dirty=e;for(var t=e?"$validate":"$reset",n=this.dynamicKeys,r=0;r<n.length;r++){var i=n[r],o=this[i];u(o)&&o[t]()}}function y(e){this.setErrors=[];for(var t=0;t<e.length;t++){var n=e[t];this.name===n.field&&(this.dirty=!0,this.setErrors.push(n))}for(var r=this.dynamicKeys,i=0;i<r.length;i++){var o=r[i],a=this[o];u(a)&&a.$setErrors(e)}}function p(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=Object.keys(e).filter(function(t){return!!e[t]}),o=i.map(C),a=O(i,function(i){var o=e[i];return g(n,o,i,t,r)},C),u=v(n),s=new u({data:{dirty:!1,dynamicKeys:o,name:r,setErrors:[]},methods:N,computed:K({},a,P)});return m(s,i)}function g(e,t,n,r,i){return o(t)?$(e,t,n,r,i):b(e,t,n,r,i)}function m(e,t){var n=K({},O(t,function(t){var n=C(t);return{enumerable:!0,get:function(){return d(e,n)}}}),O(k,function(t){return{enumerable:!0,get:function(){return e[t]}}}),O(R,function(t){return{value:e[t].bind(e)}}),{__isValidity:{configurable:!1,enumerable:!1,value:!0}});return Object.defineProperties({},n)}function $(e,t,n,r,i){return function(){var n={};t.options&&(n=t.options.reduce(function(e,t){return e[t.name]=t.value,e},{}));var o=t.validate.call(e,r[i],n,r);if(a(o)&&o.__isValidity)return o;var u=t.message.call(e,i,n,r);return{$value:!!o,$message:u}}}function b(e,t,n,r,i){if(Array.isArray(t)){for(var o={},a=0;a<t.length;a++){var u=t[a],s=[],l=u.indexOf(":"),c=l!==-1;c&&(s=u.substr(l+1).split(","),u=u.substr(0,l));var f=S[u];if(f){for(var d=0;d<s.length;d++){var v=s[d],h=f.options[d];h.value=v}o[u]=f}else console.error("Validator for rule "+u+"not found.")}t=o}var y="string"==typeof i?r[i]:r,g=p(t,y,e,n);return E(g)}var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E=function(e){return function(){return e}},O=function(e,t,n){return e.reduce(function(e,r){return e[n?n(r):r]=t(r),e},{})},j=function e(t){return t.reduce(function(t,n){return t.concat(Array.isArray(n)?e(n):n)},[])},w={touched:"touched",untouched:"untouched",valid:"valid",invalid:"invalid",pristine:"pristine",dirty:"dirty"},V=function(e){return{bind:function(t,n,r){l(t,e),t.onfocus=function(){s(t,e)},f(t,n,r,e),t.onblur=function(){var e=c(n,r);e&&e.$validate()}},inserted:function(t,n,r){f(t,n,r,e)},update:function(t,n,r){f(t,n,r,e)}}},A={required:"{field} is required.",minlength:"{field} should be at least {minlength} chars.",init:function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},getErrorMessage:function(e,t,n){var r=this[e];if(!r)return null;if(r=r.replace(new RegExp(/{field}/,"g"),t),n)for(var i in n)n.hasOwnProperty(i)&&(r=r.replace(new RegExp("{"+i+"}","g"),n[i]));return r}},M={validate:function(e,t,n){return Array.isArray(e)?!!e.length:void 0!==e&&null!==e&&!!String(e).length},message:function(e,t){return A.getErrorMessage("required",e,t)}},_={options:[{name:"minlength",value:0}],validate:function(e,t,n){var r=parseInt(t.minlength,10);return Array.isArray(e)?0===e.length||e.length>=r:void 0===e||null===e||(""===e||String(e).length>=r)},message:function(e,t,n){return A.getErrorMessage("minlength",e,t)}},S={required:M,minlength:_,add:function(e,t){return this[e]?void(this[e]=Object.assign(this[e],t)):void(this[e]=t)}},K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L=null,N={$validate:function(e){this.setErrors=[],h.call(this,!0),"function"==typeof e&&e()},$reset:function(){this.setErrors=[],h.call(this,!1)},$setErrors:function(e){y.call(this,e)}},P={$valid:function(){var e=this;return!this.setErrors.length&&!this.dynamicKeys.some(function(t){var n=d(e,t);return u(n)?!n.$valid:!n.$value})},$dirty:function(){if(this.dirty)return!0;for(var e=this.dynamicKeys,t=!1,n=0;n<e.length;n++){var r=e[n],i=this[r],o=u(i);if(t=t||o,o&&i.$dirty)return!0}return t},$error:function(){return!(!this.$dirty||this.$valid)},$errors:function(){var e=this;if(!this.$error)return[];if(this.setErrors.length)return this.setErrors;var t=this.$data.name,n=this.dynamicKeys.map(function(n){var r=e[n];return u(r)?r.$errors:r.$value?null:{field:t,message:r.$message}}).filter(function(e){return null!==e});return j(n)}},R=Object.keys(N),k=Object.keys(P),q="v$$",C=function(e){return q+e},I=function(e,t){return p(t,e)},D={beforeCreate:function(){var e=this,n=this.$options,r=!!n.validations,i=n.validations;if("undefined"==typeof n.computed&&(n.computed={}),r)n.computed.$v=function(){return I(e,i)};else if(n.parent&&n.parent.$v){if(n.validatable)return void(this.$v=n.parent.$v);var o=n._parentVnode.data.directives||[],a=o.filter(function(e){return"model"===e.name});if(a.length){var u=t(n.parent.$v,a[0].expression);this.$v=u,this.$vChild=!0}}}},z=function e(t,n){e.isInstalled||(n||(n={}),A.init(n.errorMessages),t.directive(n.directiveName||"validity",V(n.inputClasses)),t.mixin(D),e.isInstalled=!0)};"undefined"!=typeof window&&(window.VueValidity=z),z.extend=function(e,t){S.add(e,t)},Object.keys(S).forEach(function(e){z.extend(e,S[e])});var B=A.getErrorMessage;e.validationMixin=D,e.validationDirective=V,e.VueValidity=z,e.getErrorMessage=B,e.default=z,Object.defineProperty(e,"__esModule",{value:!0})});
